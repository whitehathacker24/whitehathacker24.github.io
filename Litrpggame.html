<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Awakening | LitRPG Prototype</title>
    <style>
        /* CSS: The "System" Aesthetic */
        :root {
            --system-blue: #00f0ff;
            --system-bg: #0a0f14;
            --system-panel: rgba(0, 20, 40, 0.85);
            --danger: #ff4444;
            --success: #44ff44;
            --gold: #ffd700;
        }

        body {
            background-color: #000;
            background-image: radial-gradient(circle at center, #112 0%, #000 100%);
            color: white;
            font-family: 'Courier New', Courier, monospace;
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            user-select: none;
        }

        /* The Main Game Container */
        #game-container {
            width: 900px;
            height: 600px;
            border: 2px solid var(--system-blue);
            box-shadow: 0 0 20px var(--system-blue);
            background-color: var(--system-panel);
            display: grid;
            grid-template-columns: 250px 1fr;
            grid-template-rows: 60px 1fr 150px;
            border-radius: 10px;
            overflow: hidden;
        }

        /* Header */
        header {
            grid-column: 1 / -1;
            border-bottom: 1px solid var(--system-blue);
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(0, 240, 255, 0.1);
        }

        h1 { font-size: 20px; margin: 0; text-transform: uppercase; letter-spacing: 2px; }

        /* Left Panel: Stats */
        aside {
            grid-row: 2 / -1;
            border-right: 1px solid var(--system-blue);
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
        }

        .stat-val { color: var(--system-blue); font-weight: bold; }
        
        .btn-plus {
            background: none;
            border: 1px solid var(--system-blue);
            color: var(--system-blue);
            cursor: pointer;
            width: 20px;
            height: 20px;
            line-height: 18px;
            text-align: center;
            border-radius: 3px;
        }
        .btn-plus:hover { background: var(--system-blue); color: black; }
        .hidden { visibility: hidden; }

        /* Main Log Area */
        main {
            grid-column: 2;
            grid-row: 2;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            scroll-behavior: smooth;
        }

        .log-entry { margin-bottom: 8px; line-height: 1.4; opacity: 0; animation: fadeIn 0.3s forwards; }
        .log-sys { color: var(--system-blue); }
        .log-combat { color: #ddd; }
        .log-danger { color: var(--danger); }
        .log-loot { color: var(--gold); }
        .log-lvl { color: var(--success); font-weight: bold; text-shadow: 0 0 5px var(--success); }

        @keyframes fadeIn { to { opacity: 1; } }

        /* Bottom Controls */
        #controls {
            grid-column: 2;
            grid-row: 3;
            border-top: 1px solid var(--system-blue);
            padding: 20px;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .btn-action {
            background: rgba(0, 240, 255, 0.1);
            border: 1px solid var(--system-blue);
            color: white;
            padding: 10px 20px;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
        }

        .btn-action:hover {
            background: var(--system-blue);
            color: black;
            box-shadow: 0 0 10px var(--system-blue);
        }

        .btn-action:disabled {
            border-color: #555;
            color: #555;
            background: transparent;
            cursor: not-allowed;
            box-shadow: none;
        }

        /* Bars */
        .bar-container { width: 100%; background: #333; height: 10px; margin-top: 5px; }
        .bar-fill { height: 100%; transition: width 0.3s; }
        #hp-bar { background-color: var(--danger); width: 100%; }
        #xp-bar { background-color: var(--gold); width: 0%; }

    </style>
</head>
<body>

    <div id="game-container">
        <header>
            <div>SYSTEM INTERFACE v1.0</div>
            <div id="player-name">Player: Unawakened</div>
        </header>

        <aside>
            <div style="text-align:center; color: var(--system-blue); margin-bottom: 10px;">STATUS</div>
            
            <div class="stat-row">
                <span>Level:</span> <span id="level-val" class="stat-val">1</span>
            </div>
            
            <div>
                <div class="stat-row"><span>HP:</span> <span id="hp-text">100/100</span></div>
                <div class="bar-container"><div id="hp-bar" class="bar-fill"></div></div>
            </div>

            <div>
                <div class="stat-row"><span>XP:</span> <span id="xp-text">0/100</span></div>
                <div class="bar-container"><div id="xp-bar" class="bar-fill"></div></div>
            </div>

            <hr style="border-color: #333; width: 100%;">

            <div class="stat-row">
                <span>Unassigned Points:</span> <span id="sp-val" style="color:var(--gold)">0</span>
            </div>

            <div class="stat-row">
                <span>STR (Dmg):</span> 
                <div>
                    <span id="str-val" class="stat-val">5</span>
                    <button class="btn-plus hidden" onclick="game.addStat('str')">+</button>
                </div>
            </div>
            <div class="stat-row">
                <span>VIT (HP):</span> 
                <div>
                    <span id="vit-val" class="stat-val">5</span>
                    <button class="btn-plus hidden" onclick="game.addStat('vit')">+</button>
                </div>
            </div>
            <div class="stat-row">
                <span>AGI (Spd):</span> 
                <div>
                    <span id="agi-val" class="stat-val">5</span>
                    <button class="btn-plus hidden" onclick="game.addStat('agi')">+</button>
                </div>
            </div>
        </aside>

        <main id="game-log">
            <div class="log-entry log-sys">[SYSTEM]: Initialization Complete.</div>
            <div class="log-entry log-sys">[SYSTEM]: Welcome, User. The dungeon awaits.</div>
        </main>

        <section id="controls">
            <button id="btn-explore" class="btn-action" onclick="game.explore()">Explore Dungeon</button>
            <button id="btn-rest" class="btn-action" onclick="game.rest()">Meditate (Heal)</button>
        </section>
    </div>

    <script>
        // Game State and Logic
        const game = {
            player: {
                level: 1,
                currentHp: 50,
                maxHp: 50,
                xp: 0,
                xpToNext: 100,
                stats: {
                    str: 5, // Damage
                    vit: 5, // Health pool
                    agi: 5  // Crit chance / Dodge text flavor
                },
                statPoints: 0
            },
            
            inCombat: false,
            enemy: null,

            // Core Method: Log text to the screen
            log: (msg, type = 'log-combat') => {
                const logEl = document.getElementById('game-log');
                const entry = document.createElement('div');
                entry.className = `log-entry ${type}`;
                entry.innerHTML = msg;
                logEl.appendChild(entry);
                logEl.scrollTop = logEl.scrollHeight; // Auto scroll
            },

            // Update UI elements based on state
            updateUI: () => {
                const p = game.player;
                
                // Stats
                document.getElementById('level-val').innerText = p.level;
                document.getElementById('hp-text').innerText = `${Math.floor(p.currentHp)}/${p.maxHp}`;
                document.getElementById('hp-bar').style.width = `${(p.currentHp / p.maxHp) * 100}%`;
                
                document.getElementById('xp-text').innerText = `${Math.floor(p.xp)}/${p.xpToNext}`;
                document.getElementById('xp-bar').style.width = `${(p.xp / p.xpToNext) * 100}%`;

                document.getElementById('str-val').innerText = p.stats.str;
                document.getElementById('vit-val').innerText = p.stats.vit;
                document.getElementById('agi-val').innerText = p.stats.agi;
                document.getElementById('sp-val').innerText = p.statPoints;

                // Toggle Plus Buttons
                const btns = document.querySelectorAll('.btn-plus');
                btns.forEach(b => b.classList.toggle('hidden', p.statPoints <= 0));

                // Button states
                document.getElementById('btn-explore').disabled = game.inCombat;
                document.getElementById('btn-rest').disabled = game.inCombat || p.currentHp >= p.maxHp;
            },

            // Calculate Max HP based on Vitality
            recalcStats: () => {
                const oldMax = game.player.maxHp;
                game.player.maxHp = game.player.stats.vit * 10;
                // Heal the difference if max went up
                if (game.player.maxHp > oldMax) {
                    game.player.currentHp += (game.player.maxHp - oldMax);
                }
                game.updateUI();
            },

            addStat: (stat) => {
                if (game.player.statPoints > 0) {
                    game.player.stats[stat]++;
                    game.player.statPoints--;
                    game.recalcStats();
                    game.log(`[SYSTEM]: Increased ${stat.toUpperCase()} to ${game.player.stats[stat]}.`, 'log-sys');
                }
            },

            // Encounter Logic
            explore: () => {
                if (game.inCombat) return;

                // Random enemy generator
                const enemies = [
                    { name: "Void Rat", lvl: 1, hp: 30, xp: 25, dmg: 2 },
                    { name: "Slime", lvl: 2, hp: 50, xp: 40, dmg: 4 },
                    { name: "Goblin Scout", lvl: 3, hp: 80, xp: 70, dmg: 8 }
                ];

                // Simple scaling: pick enemy based on player level range
                let possible = enemies.filter(e => e.lvl <= game.player.level + 1);
                let enemyTemplate = possible[Math.floor(Math.random() * possible.length)];
                
                // Clone enemy so we don't modify the template
                game.enemy = { ...enemyTemplate, maxHp: enemyTemplate.hp };
                game.inCombat = true;

                game.log(`[ALERT]: You encountered a <strong>Lvl ${game.enemy.lvl} ${game.enemy.name}</strong>!`, 'log-danger');
                
                // Switch controls to combat
                const controls = document.getElementById('controls');
                controls.innerHTML = `<button class="btn-action" onclick="game.attack()">Attack</button>
                                      <button class="btn-action" onclick="game.flee()">Flee</button>`;
                
                game.updateUI();
            },

            attack: () => {
                if (!game.inCombat) return;

                // Player Turn
                // Dmg = Str +/- 20%
                let pDmg = Math.floor(game.player.stats.str * (0.8 + Math.random() * 0.4));
                // Crit check based on Agility
                let critChance = game.player.stats.agi * 2; // 2% per agi point
                let isCrit = Math.random() * 100 < critChance;
                
                if (isCrit) {
                    pDmg *= 2;
                    game.log(`CRITICAL HIT! You deal ${pDmg} damage to ${game.enemy.name}!`, 'log-combat');
                } else {
                    game.log(`You hit ${game.enemy.name} for ${pDmg} damage.`, 'log-combat');
                }

                game.enemy.hp -= pDmg;

                // Check Enemy Death
                if (game.enemy.hp <= 0) {
                    game.winCombat();
                    return;
                }

                // Enemy Turn
                // Enemy damage reduced slightly by agility (dodge factor)
                let dodgeChance = game.player.stats.agi; 
                if (Math.random() * 100 < dodgeChance) {
                    game.log(`${game.enemy.name} attacks, but you dodge!`, 'log-sys');
                } else {
                    let eDmg = Math.max(1, Math.floor(game.enemy.dmg * (0.9 + Math.random() * 0.2)));
                    game.player.currentHp -= eDmg;
                    game.log(`${game.enemy.name} hits you for ${eDmg} damage.`, 'log-danger');
                }

                // Check Player Death
                if (game.player.currentHp <= 0) {
                    game.player.currentHp = 0;
                    game.log(`[DEATH]: You have been slain by ${game.enemy.name}.`, 'log-danger');
                    game.log(`[SYSTEM]: Resurrecting at safe zone... (XP Penalty Applied)`, 'log-sys');
                    game.player.xp = Math.floor(game.player.xp / 2);
                    game.player.currentHp = game.player.maxHp;
                    game.endCombat();
                }

                game.updateUI();
            },

            winCombat: () => {
                game.log(`[VICTORY]: You defeated ${game.enemy.name}!`, 'log-loot');
                game.gainXp(game.enemy.xp);
                game.endCombat();
            },

            flee: () => {
                game.log(`You fled from the ${game.enemy.name}.`, 'log-sys');
                game.endCombat();
            },

            endCombat: () => {
                game.inCombat = false;
                game.enemy = null;
                // Restore controls
                const controls = document.getElementById('controls');
                controls.innerHTML = `
                    <button id="btn-explore" class="btn-action" onclick="game.explore()">Explore Dungeon</button>
                    <button id="btn-rest" class="btn-action" onclick="game.rest()">Meditate (Heal)</button>
                `;
                game.updateUI();
            },

            gainXp: (amount) => {
                game.player.xp += amount;
                game.log(`You gained +${amount} XP.`, 'log-loot');
                
                if (game.player.xp >= game.player.xpToNext) {
                    game.levelUp();
                }
                game.updateUI();
            },

            levelUp: () => {
                game.player.level++;
                game.player.xp -= game.player.xpToNext;
                game.player.xpToNext = Math.floor(game.player.xpToNext * 1.5);
                game.player.statPoints += 3;
                
                // Full heal on level up
                game.player.currentHp = game.player.maxHp;

                game.log(`[SYSTEM NOTICE]: LEVEL UP! You are now Level ${game.player.level}.`, 'log-lvl');
                game.log(`[SYSTEM]: You gained +3 Attribute Points.`, 'log-lvl');
            },

            rest: () => {
                if (game.player.currentHp < game.player.maxHp) {
                    game.player.currentHp = Math.min(game.player.maxHp, game.player.currentHp + (game.player.stats.vit * 2));
                    game.log(`You meditate and recover health.`, 'log-sys');
                    game.updateUI();
                } else {
                    game.log(`You are already at full health.`, 'log-sys');
                }
            }
        };

        // Initialize
        game.recalcStats();
    </script>
</body>
</html>