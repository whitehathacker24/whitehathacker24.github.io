<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Math Bot</title>
    <style>
        /* Add some basic styling for better appearance */
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        #chat-box {
            width: 300px;
            border: 1px solid #ccc;
            padding: 10px;
            overflow-y: scroll;
            height: 200px;
        }
    </style>
</head>
<body>
    <h1>Advanced Math Bot</h1>
    <div>
        <label for="user-input">Ask a question:</label>
        <input type="text" id="user-input" />
        <button onclick="askQuestion()">Ask</button>
        <button onclick="clearChat()">Clear Chat</button>
    </div>
    <div id="chat-box"></div>

    <!-- Include math.js library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/10.7.1/math.min.js"></script>
    <script>
        // Load previous questions and answers from local storage (if any)
        let botMemory = JSON.parse(localStorage.getItem('botMemory')) || {};

        function solveMathWordProblem(problem) {
            // Logic to solve math word problems
            const keywords = ['plus', 'add', 'sum', 'total', 'minus', 'subtract', 'difference', 'times', 'multiply', 'multiplied', 'product', 'divided', 'quotient', 'how many', 'how much'];

            for (const keyword of keywords) {
                if (problem.includes(keyword)) {
                    try {
                        // Extract numbers from the problem
                        const numbers = problem.match(/\d+/g).map(Number);
                        const operation = problem.includes('plus') || problem.includes('add') || problem.includes('sum') || problem.includes('total') ? 'add' :
                            problem.includes('minus') || problem.includes('subtract') || problem.includes('difference') ? 'subtract' :
                            problem.includes('times') || problem.includes('multiply') || problem.includes('multiplied') ? 'multiply' :
                            problem.includes('divided') || problem.includes('quotient') ? 'divide' : '';

                        if (operation === 'add') {
                            return numbers.reduce((a, b) => a + b, 0);
                        } else if (operation === 'subtract') {
                            return numbers.reduce((a, b) => a - b);
                        } else if (operation === 'multiply') {
                            return numbers.reduce((a, b) => a * b, 1);
                        } else if (operation === 'divide') {
                            return numbers.reduce((a, b) => a / b);
                        }
                    } catch (error) {
                        return null;
                    }
                }
            }
            return null;
        }

        function convertTemperature(temp, fromUnit, toUnit) {
            // Logic to convert temperature between Celsius, Fahrenheit, and Kelvin
            if (fromUnit === 'celsius' && toUnit === 'fahrenheit') {
                return (temp * 9 / 5) + 32;
            } else if (fromUnit === 'celsius' && toUnit === 'kelvin') {
                return temp + 273.15;
            } else if (fromUnit === 'fahrenheit' && toUnit === 'celsius') {
                return (temp - 32) * 5 / 9;
            } else if (fromUnit === 'fahrenheit' && toUnit === 'kelvin') {
                return (temp - 32) * 5 / 9 + 273.15;
            } else if (fromUnit === 'kelvin' && toUnit === 'celsius') {
                return temp - 273.15;
            } else if (fromUnit === 'kelvin' && toUnit === 'fahrenheit') {
                return (temp - 273.15) * 9 / 5 + 32;
            } else {
                return null;
            }
        }

        function generateRandomNumber(min, max) {
            // Logic to generate a random number within the specified range
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function performOperationsOnList(list, operation) {
            // Logic to perform operations (addition, multiplication, etc.) on a list of numbers
            if (operation === 'add') {
                return list.reduce((a, b) => a + b, 0);
            } else if (operation === 'multiply') {
                return list.reduce((a, b) => a * b, 1);
            } else {
                return null;
            }
        }

        function calculateFactorial(number) {
            // Logic to calculate the factorial of a number
            if (number === 0 || number === 1) {
                return 1;
            } else {
                let factorial = 1;
                for (let i = 2; i <= number; i++) {
                    factorial *= i;
                }
                return factorial;
            }
        }

        function generateRandomPassword(length) {
            // Logic to generate a random password of the specified length
            const charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let password = '';
            for (let i = 0; i < length; i++) {
                const randomIndex = Math.floor(Math.random() * charset.length);
                password += charset[randomIndex];
            }
            return password;
        }

        function getFormula(userInput) {
            // Check if the user is asking for a specific formula
            const formulaName = userInput.replace('formula for', '').trim();
            const formula = formulas[formulaName.toLowerCase()];
            return formula ? formula : null;
        }

        function solveAdvancedMathProblem(userInput) {
            // Use math.js to evaluate the advanced math problem
            try {
                const result = math.evaluate(userInput);
                return result;
            } catch (error) {
                return null;
            }
        }

        function saveUserInputAndAnswer(userInput, botResponse) {
            botMemory[userInput] = { question: userInput, answer: botResponse };
            localStorage.setItem('botMemory', JSON.stringify(botMemory));
        }

        function botResponse(userInput) {
            // Check for advanced math problems using math.js (previously added function)
            const advancedMathResult = solveAdvancedMathProblem(userInput);
            if (advancedMathResult !== null) {
                const response = `The answer to "${userInput}" is: ${advancedMathResult}`;
                saveUserInputAndAnswer(userInput, response);
                return response;
            }

            // Check if the user is asking for a specific formula (previously added function)
            const formulaResult = getFormula(userInput);
            if (formulaResult !== null) {
                return formulaResult;
            }

            // Check for previously answered questions
            const previousAnswer = botMemory[userInput];
            if (previousAnswer) {
                return previousAnswer.answer;
            }

            // Check for specific interactions

            // Check for math word problems
            const wordProblemResult = solveMathWordProblem(userInput);
            if (wordProblemResult !== null) {
                const response = `The answer to "${userInput}" is: ${wordProblemResult}`;
                saveUserInputAndAnswer(userInput, response);
                return response;
            }

            // Check for temperature conversion
            const temperatureRegex = /(\d+(?:\.\d+)?)\s?(celsius|fahrenheit|kelvin)\s?to\s?(celsius|fahrenheit|kelvin)/i;
            const temperatureMatch = userInput.match(temperatureRegex);
            if (temperatureMatch) {
                const temp = parseFloat(temperatureMatch[1]);
                const fromUnit = temperatureMatch[2].toLowerCase();
                const toUnit = temperatureMatch[3].toLowerCase();
                const convertedTemp = convertTemperature(temp, fromUnit, toUnit);
                if (convertedTemp !== null) {
                    return `Converted temperature: ${convertedTemp.toFixed(2)} ${toUnit}`;
                } else {
                    return "Invalid temperature conversion.";
                }
            }

            // Check for geometry calculations
            const rectangleAreaRegex = /calculate rectangle area (\d+\.?\d*) (\d+\.?\d*)/i;
            const circleAreaRegex = /calculate circle area (\d+\.?\d*)/i;
            const rectangleAreaMatch = userInput.match(rectangleAreaRegex);
            const circleAreaMatch = userInput.match(circleAreaRegex);

            if (rectangleAreaMatch) {
                const length = parseFloat(rectangleAreaMatch[1]);
                const width = parseFloat(rectangleAreaMatch[2]);
                if (!isNaN(length) && !isNaN(width)) {
                    const area = calculateRectangleArea(length, width);
                    return `The area of the rectangle is: ${area.toFixed(2)}`;
                }
            } else if (circleAreaMatch) {
                const radius = parseFloat(circleAreaMatch[1]);
                if (!isNaN(radius)) {
                    const area = calculateCircleArea(radius);
                    return `The area of the circle is: ${area.toFixed(2)}`;
                }
            }

            // Check for algebra problems
            const quadraticEquationRegex = /solve quadratic equation (-?\d+\.?\d*) (-?\d+\.?\d*) (-?\d+\.?\d*)/i;
            const quadraticEquationMatch = userInput.match(quadraticEquationRegex);

            if (quadraticEquationMatch) {
                const a = parseFloat(quadraticEquationMatch[1]);
                const b = parseFloat(quadraticEquationMatch[2]);
                const c = parseFloat(quadraticEquationMatch[3]);
                if (!isNaN(a) && !isNaN(b) && !isNaN(c)) {
                    const solution = solveQuadraticEquation(a, b, c);
                    return solution;
                }
            }

            // Check for trigonometry problems
            const degreesToRadiansRegex = /convert degrees to radians (\d+\.?\d*)/i;
            const radiansToDegreesRegex = /convert radians to degrees (\d+\.?\d*)/i;
            const rightTriangleHypotenuseRegex = /calculate right triangle hypotenuse (\d+\.?\d*) (\d+\.?\d*)/i;

            const degreesToRadiansMatch = userInput.match(degreesToRadiansRegex);
            const radiansToDegreesMatch = userInput.match(radiansToDegreesRegex);
            const rightTriangleHypotenuseMatch = userInput.match(rightTriangleHypotenuseRegex);

            if (degreesToRadiansMatch) {
                const degrees = parseFloat(degreesToRadiansMatch[1]);
                if (!isNaN(degrees)) {
                    const radians = convertDegreesToRadians(degrees);
                    return `The value in radians is: ${radians.toFixed(2)}`;
                }
            } else if (radiansToDegreesMatch) {
                const radians = parseFloat(radiansToDegreesMatch[1]);
                if (!isNaN(radians)) {
                    const degrees = convertRadiansToDegrees(radians);
                    return `The value in degrees is: ${degrees.toFixed(2)}`;
                }
            } else if (rightTriangleHypotenuseMatch) {
                const base = parseFloat(rightTriangleHypotenuseMatch[1]);
                const height = parseFloat(rightTriangleHypotenuseMatch[2]);
                if (!isNaN(base) && !isNaN(height)) {
                    const hypotenuse = calculateRightTriangleHypotenuse(base, height);
                    return `The length of the hypotenuse is: ${hypotenuse.toFixed(2)}`;
                }
            }

            // Check for statistics problems
            const calculateMeanRegex = /calculate mean (.+)/i;
            const calculateMedianRegex = /calculate median (.+)/i;
            const calculateStandardDeviationRegex = /calculate standard deviation (.+)/i;

            const calculateMeanMatch = userInput.match(calculateMeanRegex);
            const calculateMedianMatch = userInput.match(calculateMedianRegex);
            const calculateStandardDeviationMatch = userInput.match(calculateStandardDeviationRegex);

            if (calculateMeanMatch) {
                const numbers = userInput.match(/-?\d+\.?\d*/g).map(Number);
                if (numbers.length > 0) {
                    const mean = calculateMean(numbers);
                    return `The mean of the numbers is: ${mean.toFixed(2)}`;
                }
            } else if (calculateMedianMatch) {
                const numbers = userInput.match(/-?\d+\.?\d*/g).map(Number);
                if (numbers.length > 0) {
                    const median = calculateMedian(numbers);
                    return `The median of the numbers is: ${median.toFixed(2)}`;
                }
            } else if (calculateStandardDeviationMatch) {
                const numbers = userInput.match(/-?\d+\.?\d*/g).map(Number);
                if (numbers.length > 0) {
                    const stDeviation = calculateStandardDeviation(numbers);
                    return `The standard deviation of the numbers is: ${stDeviation.toFixed(2)}`;
                }
            }

            // If it's a new question, prompt the user to provide an answer
            const newAnswer = prompt(`You asked: "${userInput}"\n\nBot doesn't know the answer. Please provide one:`);
            if (newAnswer) {
                saveUserInputAndAnswer(userInput, newAnswer);
                return `You asked: "${userInput}"\nBot: ${newAnswer}`;
            } else {
                return "I'm sorry, I couldn't understand your question.";
            }
        }

        function askQuestion() {
            const userInput = document.getElementById('user-input').value;
            if (userInput.trim() === '') return; // Ignore empty questions

            const chatBox = document.getElementById('chat-box');

            // Get the bot's response based on user input
            const botResponseText = botResponse(userInput);

            // Show the user's question and bot's response in the chat box
            chatBox.innerHTML += `<p><strong>You:</strong> ${userInput}</p>`;
            chatBox.innerHTML += `<p><strong>Bot:</strong> ${botResponseText}</p>`;

            // Clear the input field after processing the question
            document.getElementById('user-input').value = '';

            // Scroll to the bottom of the chat box to show the latest message
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        function clearChat() {
            // Clear the chat history and local storage
            const chatBox = document.getElementById('chat-box');
            chatBox.innerHTML = '';
            localStorage.removeItem('botMemory');
            botMemory = {};
        }

        // Additional formulas
        const formulas = {
            'area of ellipse': 'Area = π * a * b',
            'volume of sphere': 'Volume = (4/3) * π * r^3',
            'surface area of torus': 'Surface Area = 4 * π^2 * R * r',
            // Add more formulas here
            // ...
        };

        // Additional geometry functions
        function calculateRectangleArea(length, width) {
            return length * width;
        }

        function calculateCircleArea(radius) {
            return Math.PI * radius * radius;
        }

        // Additional algebra functions
        function solveQuadraticEquation(a, b, c) {
            const discriminant = b * b - 4 * a * c;
            if (discriminant < 0) {
                return "The quadratic equation has no real roots.";
            } else if (discriminant === 0) {
                const root = -b / (2 * a);
                return `The quadratic equation has a single real root: x = ${root}`;
            } else {
                const root1 = (-b + Math.sqrt(discriminant)) / (2 * a);
                const root2 = (-b - Math.sqrt(discriminant)) / (2 * a);
                return `The quadratic equation has two real roots: x₁ = ${root1}, x₂ = ${root2}`;
            }
        }

        // Additional trigonometry functions
        function convertDegreesToRadians(degrees) {
            return degrees * (Math.PI / 180);
        }

        function convertRadiansToDegrees(radians) {
            return radians * (180 / Math.PI);
        }

        function calculateRightTriangleHypotenuse(base, height) {
            return Math.sqrt(base * base + height * height);
        }

        // Additional statistics functions
        function calculateMean(numbers) {
            return numbers.reduce((sum, num) => sum + num, 0) / numbers.length;
        }

        function calculateMedian(numbers) {
            const sortedNumbers = numbers.slice().sort((a, b) => a - b);
            const middle = Math.floor(sortedNumbers.length / 2);
            if (sortedNumbers.length % 2 === 0) {
                return (sortedNumbers[middle - 1] + sortedNumbers[middle]) / 2;
            } else {
                return sortedNumbers[middle];
            }
        }

        function calculateStandardDeviation(numbers) {
            const mean = calculateMean(numbers);
            const squaredDifferences = numbers.map(num => (num - mean) * (num - mean));
            const variance = squaredDifferences.reduce((sum, num) => sum + num, 0) / numbers.length;
            return Math.sqrt(variance);
        }

        // Additional calculus functions
        function calculateDerivative(expression, variable) {
            try {
                const derivative = math.derivative(expression, variable);
                return derivative.toString();
            } catch (error) {
                return "Error: Unable to calculate the derivative.";
            }
        }

        function calculateIntegral(expression, variable, lowerLimit, upperLimit) {
            try {
                const integral = math.integral(expression, variable, { from: lowerLimit, to: upperLimit });
                return integral.toString();
            } catch (error) {
                return "Error: Unable to calculate the integral.";
            }
        }

    </script>
</body>
</html>
