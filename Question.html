<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Math Bot</title>
    <style>
        /* Add some basic styling for better appearance */
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        #chat-box {
            width: 300px;
            border: 1px solid #ccc;
            padding: 10px;
            overflow-y: scroll;
            height: 200px;
        }
    </style>
</head>
<body>
    <h1>Advanced Math Bot</h1>
    <div>
        <label for="user-input">Ask a question:</label>
        <input type="text" id="user-input" />
        <button onclick="askQuestion()">Ask</button>
        <button onclick="clearChat()">Clear Chat</button>
    </div>
    <div id="chat-box"></div>

    <!-- Include math.js library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/10.7.1/math.min.js"></script>
    <script>
        // Load previous questions and answers from local storage (if any)
        let botMemory = JSON.parse(localStorage.getItem('botMemory')) || {};

        function solveMathWordProblem(problem) {
            // Logic to solve math word problems
            const keywords = ['plus', 'add', 'sum', 'total', 'minus', 'subtract', 'difference', 'times', 'multiply', 'multiplied', 'product', 'divided', 'quotient', 'how many', 'how much'];

            for (const keyword of keywords) {
                if (problem.includes(keyword)) {
                    try {
                        // Extract numbers from the problem
                        const numbers = problem.match(/\d+/g).map(Number);
                        const operation = problem.includes('plus') || problem.includes('add') || problem.includes('sum') || problem.includes('total') ? 'add' :
                            problem.includes('minus') || problem.includes('subtract') || problem.includes('difference') ? 'subtract' :
                            problem.includes('times') || problem.includes('multiply') || problem.includes('multiplied') ? 'multiply' :
                            problem.includes('divided') || problem.includes('quotient') ? 'divide' : '';

                        if (operation === 'add') {
                            return numbers.reduce((a, b) => a + b, 0);
                        } else if (operation === 'subtract') {
                            return numbers.reduce((a, b) => a - b);
                        } else if (operation === 'multiply') {
                            return numbers.reduce((a, b) => a * b, 1);
                        } else if (operation === 'divide') {
                            return numbers.reduce((a, b) => a / b);
                        }
                    } catch (error) {
                        return null;
                    }
                }
            }
            return null;
        }

        function convertTemperature(temp, fromUnit, toUnit) {
            // Logic to convert temperature between Celsius, Fahrenheit, and Kelvin
            if (fromUnit === 'celsius' && toUnit === 'fahrenheit') {
                return (temp * 9 / 5) + 32;
            } else if (fromUnit === 'celsius' && toUnit === 'kelvin') {
                return temp + 273.15;
            } else if (fromUnit === 'fahrenheit' && toUnit === 'celsius') {
                return (temp - 32) * 5 / 9;
            } else if (fromUnit === 'fahrenheit' && toUnit === 'kelvin') {
                return (temp - 32) * 5 / 9 + 273.15;
            } else if (fromUnit === 'kelvin' && toUnit === 'celsius') {
                return temp - 273.15;
            } else if (fromUnit === 'kelvin' && toUnit === 'fahrenheit') {
                return (temp - 273.15) * 9 / 5 + 32;
            } else {
                return null;
            }
        }

        function generateRandomNumber(min, max) {
            // Logic to generate a random number within the specified range
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function performOperationsOnList(list, operation) {
            // Logic to perform operations (addition, multiplication, etc.) on a list of numbers
            if (operation === 'add') {
                return list.reduce((a, b) => a + b, 0);
            } else if (operation === 'multiply') {
                return list.reduce((a, b) => a * b, 1);
            } else {
                return null;
            }
        }

        function calculateFactorial(number) {
            // Logic to calculate the factorial of a number
            if (number === 0 || number === 1) {
                return 1;
            } else {
                let factorial = 1;
                for (let i = 2; i <= number; i++) {
                    factorial *= i;
                }
                return factorial;
            }
        }

        function generateRandomPassword(length) {
            // Logic to generate a random password of the specified length
            const charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let password = '';
            for (let i = 0; i < length; i++) {
                const randomIndex = Math.floor(Math.random() * charset.length);
                password += charset[randomIndex];
            }
            return password;
        }

        function getFormula(userInput) {
            // Check if the user is asking for a specific formula
            const formulaName = userInput.replace('formula for', '').trim();
            const formula = formulas[formulaName.toLowerCase()];
            return formula ? formula : null;
        }

        function solveAdvancedMathProblem(userInput) {
            // Use math.js to evaluate the advanced math problem
            try {
                const result = math.evaluate(userInput);
                return result;
            } catch (error) {
                return null;
            }
        }

        function botResponse(userInput) {
            // Check for advanced math problems using math.js (previously added function)
            const advancedMathResult = solveAdvancedMathProblem(userInput);
            if (advancedMathResult !== null) {
                return `The answer to "${userInput}" is: ${advancedMathResult}`;
            }

            // Check if the user is asking for a specific formula (previously added function)
            const formulaResult = getFormula(userInput);
            if (formulaResult !== null) {
                return `The formula for "${userInput}" is: ${formulaResult}`;
            }

            // Check for specific interactions (previously added functions)

            // Check for math word problems
            const wordProblemResult = solveMathWordProblem(userInput);
            if (wordProblemResult !== null) {
                return `The answer to "${userInput}" is: ${wordProblemResult}`;
            }

            // Check for temperature conversion
            const tempConversionResult = convertTemperature(userInput);
            if (tempConversionResult !== null) {
                return tempConversionResult;
            }

            // If it's a new question, prompt the user to provide an answer
            const newAnswer = prompt(`You asked: "${userInput}"\n\nBot doesn't know the answer. Please provide one:`);
            if (newAnswer) {
                botMemory[userInput] = newAnswer;
                localStorage.setItem('botMemory', JSON.stringify(botMemory));
                return `You asked: "${userInput}"\nBot: ${newAnswer}`;
            } else {
                return "I'm sorry, I couldn't understand your question.";
            }
        }

        function askQuestion() {
            const userInput = document.getElementById('user-input').value;
            if (userInput.trim() === '') return; // Ignore empty questions

            const chatBox = document.getElementById('chat-box');

            // Get the bot's response based on user input
            const botResponseText = botResponse(userInput);

            // Show the user's question and bot's response in the chat box
            chatBox.innerHTML += `<p><strong>You:</strong> ${userInput}</p>`;
            chatBox.innerHTML += `<p><strong>Bot:</strong> ${botResponseText}</p>`;

            // Clear the input field after processing the question
            document.getElementById('user-input').value = '';

            // Scroll to the bottom of the chat box to show the latest message
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        function clearChat() {
            // Clear the chat history and local storage
            const chatBox = document.getElementById('chat-box');
            chatBox.innerHTML = '';
            localStorage.removeItem('botMemory');
            botMemory = {};
        }

        // Additional functions (solveAdvancedMathProblem, botResponse)

        // Additional formulas
        const formulas = {
            'area of ellipse': 'Area = π * a * b',
            'volume of sphere': 'Volume = (4/3) * π * r^3',
            'surface area of torus': 'Surface Area = 4 * π^2 * R * r',
            // Add more formulas here
            // ...
        };

    </script>
</body>
</html>
